{% extends "base.html" %}

{% block title %}å·¥å…·ç®¡ç† - MartletMolt{% endblock %}

{% block content %}
<header class="h-16 border-b border-gray-200 dark:border-slate-700 flex items-center px-6 bg-white dark:bg-slate-900 flex-shrink-0">
    <h1 class="text-lg font-semibold text-gray-900 dark:text-gray-100">å·¥å…·ç®¡ç†</h1>
</header>

<div class="flex-1 overflow-y-auto p-8" x-data="toolsApp()" x-init="init()">
    <div class="max-w-4xl mx-auto space-y-6">
        
        <div class="flex items-center justify-between">
            <div>
                <h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100">å¯ç”¨å·¥å…·</h2>
                <p class="text-sm text-gray-500 mt-1">MartletMolt ç›®å‰å¯ä»¥è¨ªå•çš„å·¥å…·æ’ä»¶åˆ—è¡¨ã€‚</p>
            </div>
            <div class="bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 px-4 py-2 rounded-xl text-sm font-medium border border-blue-100 dark:border-blue-800">
                å…± <span x-text="tools.length"></span> å€‹å·¥å…·
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <template x-for="tool in tools" :key="tool.name">
                <div class="bg-white dark:bg-slate-800 p-6 rounded-2xl border border-gray-200 dark:border-slate-700 shadow-sm hover:shadow-md transition-all group">
                    <div class="flex items-start justify-between mb-4">
                        <div class="w-12 h-12 bg-gray-100 dark:bg-slate-700 rounded-xl flex items-center justify-center text-2xl group-hover:scale-110 transition-transform">
                            <span x-text="getIcon(tool.name)"></span>
                        </div>
                        <div class="flex items-center">
                            <span :class="tool.enabled ? 'bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400' : 'bg-gray-100 text-gray-500'" 
                                  class="px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wider">
                                <span x-text="tool.enabled ? 'Active' : 'Disabled'"></span>
                            </span>
                        </div>
                    </div>
                    
                    <h3 class="text-lg font-bold text-gray-900 dark:text-gray-100 mb-2 font-mono" x-text="tool.name"></h3>
                    <p class="text-sm text-gray-500 dark:text-slate-400 leading-relaxed" x-text="tool.description"></p>
                    
                    <div class="mt-6 flex justify-end">
                        <button class="text-xs font-semibold text-blue-600 dark:text-blue-400 hover:underline cursor-not-allowed opacity-50">
                            è¨­å®šåƒæ•¸ (é–‹ç™¼ä¸­)
                        </button>
                    </div>
                </div>
            </template>
        </div>

        <!-- è¼‰å…¥ä¸­ -->
        <template x-if="isLoading">
            <div class="flex justify-center py-12">
                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
            </div>
        </template>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function toolsApp() {
    return {
        tools: [],
        isLoading: true,
        backendUrl: '{{ backend_url }}',

        async init() {
            await this.fetchTools();
        },

        async fetchTools() {
            this.isLoading = true;
            try {
                const response = await fetch(`${this.backendUrl}/settings/tools`);
                if (response.ok) {
                    const data = await response.json();
                    this.tools = data.tools;
                }
            } catch (error) {
                console.error('Failed to fetch tools:', error);
            } finally {
                this.isLoading = false;
            }
        },

        getIcon(name) {
            const icons = {
                'web_search': 'ğŸŒ',
                'shell': 'ğŸ’»',
                'file_read': 'ğŸ“–',
                'file_write': 'ğŸ“',
                'web_navigate': 'ğŸ§­',
                'web_click': 'ğŸ–±ï¸',
                'web_extract': 'ğŸ“„',
                'iot_control': 'ğŸ’¡',
                'skill_manager': 'ğŸ§ '
            };
            return icons[name] || 'ğŸ› ï¸';
        }
    }
}
</script>
{% endblock %}
