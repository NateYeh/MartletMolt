# TASK-013: æ–‡ä»¶ä¸Šå‚³ API èˆ‡å„²å­˜ (å¾…å•Ÿå‹• ğŸ“„)

**å»ºç«‹æ—¥æœŸ**: 2025-02-22  
**å„ªå…ˆç´š**: é«˜  
**ç‹€æ…‹**: ğŸ“‹ å¾…é–‹ç™¼

---

## ğŸ“‹ ä»»å‹™æ¦‚è¿°

ç‚ºäº†è®“ MartletMolt å…·å‚™åˆ†ææœ¬åœ°æ–‡ä»¶çš„èƒ½åŠ›ï¼Œå¾Œç«¯éœ€è¦å…·å‚™æ¥æ”¶ã€å„²å­˜ä¸¦ç´¢å¼•æ–‡ä»¶çš„åŠŸèƒ½ã€‚æœ¬ä»»å‹™å°ˆæ³¨æ–¼åŸºç¤çš„ä¸Šå‚³æµç¨‹èˆ‡æª”æ¡ˆç®¡ç†ã€‚

---

## ğŸ¯ ç›®éŒ„èˆ‡ç›®æ¨™

- [ ] å¯¦ä½œ `POST /api/upload` APIã€‚
- [ ] å»ºç«‹ `shared/data/uploads` ç›®éŒ„ç”¨æ–¼å¯¦é«”å„²å­˜ã€‚
- [ ] æ”¯æ´å¸¸è¦‹æ ¼å¼é©—è­‰ï¼ˆ.txt, .md, .pdf, .pyï¼‰ã€‚
- [ ] å›å‚³æª”æ¡ˆå…ƒæ•¸æ“šï¼ˆfile_id, size, filenameï¼‰ä¾›å‰ç«¯èˆ‡ Agent å¼•ç”¨ã€‚

---

## ğŸ› ï¸ æŠ€è¡“å¯¦ä½œè·¯å¾‘

### 1. API è¨­è¨ˆ
ä½¿ç”¨ FastAPI çš„ `UploadFile` æ¨¡çµ„ï¼š
```python
@router.post("/api/upload")
async def upload_file(file: UploadFile = File(...)):
    # å„²å­˜é‚è¼¯
```

### 2. æª”æ¡ˆå„²å­˜
- å°‡æª”æ¡ˆå„²å­˜è‡³è¨­å®šè·¯å¾‘ã€‚
- ä½¿ç”¨ `uuid` é‡æ–°å‘½åæª”æ¡ˆä»¥é¿å…è¡çªï¼Œä¸¦ä¿ç•™åŸæª”åæ–¼å…ƒæ•¸æ“šã€‚

### 3. èˆ‡æœƒè©±é—œè¯
- è€ƒæ…®æ˜¯å¦å°‡æª”æ¡ˆèˆ‡ç‰¹å®šçš„ `session_id` ç¶å®šã€‚

---

## ğŸ“ ä¿®æ”¹è·¯å¾‘æ¸…å–®

- `backend/system_a/martlet_molt/gateway/routes.py` (æ–°å¢è·¯ç”±)
- `backend/system_a/martlet_molt/core/config.py` (æ–°å¢ uploads_dir è¨­å®š)
- `backend/system_a/requirements.txt` (è‹¥éœ€ PDF è§£æå‰‡æ–°å¢ç›¸æ‡‰å¥—ä»¶)

---

## âœ… é©—è­‰æ–¹å¼

1. ä½¿ç”¨ `curl -F "file=@test.txt" http://localhost:8001/api/upload` æ¸¬è©¦ä¸Šå‚³ã€‚
2. æª¢æŸ¥ `shared/data/uploads` ç›®éŒ„ä¸‹æ˜¯å¦å‡ºç¾å¯¦é«”æª”æ¡ˆã€‚
3. ç¢ºèª API å›å‚³çš„ JSON åŒ…å«å¯ç”¨çš„ `file_id`ã€‚
4. åŸ·è¡Œ `ruff check --fix` èˆ‡ `pyright`ã€‚
